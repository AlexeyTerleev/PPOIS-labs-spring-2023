# Lab2
Реализация модели MVC(Model-View-Controller)
## Record и XmlRecordRepository
Предоставленный код включает определения двух классов: `Record` и `XmlRecordRepository`. Эти классы используются для представления спортивных записей и управления репозиторием записей, хранящихся в формате XML. Вот краткое описание каждого класса и его методов:
### Класс Record
Класс `Record` представляет спортивную запись и имеет следующие атрибуты:
- `fullName`: Полное имя владельца записи.
- `rank`: Ранг записи.
- `sport`: Спорт, связанный с записью.
- `position`: Позиция владельца записи.
- `squad`: Команда, в которой состоит владелец записи.
- `titles`: Список наград или достижений, связанных с записью.

Класс предоставляет следующий метод:
- `to_list()`: Преобразует атрибуты объекта `Record` в список.

### Класс XmlRecordRepository
Класс `XmlRecordRepository` представляет репозиторий для управления объектами `Record`, использующий XML в качестве формата хранения. Он обеспечивает следующую функциональность:
- Инициализацию репозитория путем загрузки записей из XML-файла, указанного в параметре `path`.
- Сохранение записей обратно в XML-файл.
- Получение всех записей в репозитории.
- Добавление новой записи в репозиторий.
- Удаление записи из репозитория на основе параметра `fullName`.

### Зависимости
Для работы кода требуются следующие внешние библиотеки:
- `json`: Используется для разбора наград в формате JSON внутри XML-записей.
- `xml.dom.minidom`: Используется для создания и манипуляции XML-документами.
- `bs4.BeautifulSoup`: Используется для разбора и навигации по XML-данным.

## Контроллер (Controller)

Класс `Controller` представляет контроллер, который обеспечивает взаимодействие между пользовательским интерфейсом и моделью данных. Он содержит методы для выполнения различных операций над записями спортивных рекордов.

## Методы контроллера:
- `__init__(self, path)`: Конструктор класса `Controller`, который инициализирует объект модели `XmlRecordRepository` с указанным путем `path`.
- `change_model(self, path)`: Метод для изменения модели, заменяет текущий объект модели `XmlRecordRepository` на новый, созданный с указанным путем `path`.
- `make_record(self, name, rank, sport, position, squad, titles)`: Метод для создания новой записи с указанными атрибутами и добавления ее в модель данных.
- `get_records(self)`: Метод для получения всех записей из модели данных.
- `get_record_list(self)`: Метод для получения списка записей в формате списка списков, где каждый вложенный список содержит атрибуты записи.
- `get_ranks(self) -> list[str]`: Метод для получения уникального списка рангов записей.
- `get_sports(self) -> set[str]`: Метод для получения уникального списка спортов записей
- `get_title_values(self) -> set[int]`: Метод для получения уникального списка количества наград для записей.
- `filter_sports(self, filter_sport: str, filtered_records: list = None)`: Метод для фильтрации записей по указанному спорту. Может принимать необязательный аргумент `filtered_records`, который представляет список записей, по которым нужно выполнить фильтрацию.
- `filter_rank(self, filter_rank: str, filtered_records: list = None)`: Метод для фильтрации записей по указанному рангу. Может принимать необязательный аргумент `filtered_records`, который представляет список записей, по которым нужно выполнить фильтрацию.
- `filter_titles_values(self, filter_value, filtered_records: list = None)`: Метод для фильтрации записей по указанному количеству наград. Может принимать необязательный аргумент `filtered_records`, который представляет список записей, по которым нужно выполнить фильтрацию.
- `search_by_name(self, search_name, filtered_records: list = None)`: Метод для поиска записей по указанному имени. Может принимать необязательный аргумент `filtered_records`, который представляет список записей, в котором нужно выполнить поиск.
- `convert_records_to_list(self, records) -> list[str]`: Метод для преобразования списка записей в список строковых представлений записей.
- `remove_elm(self, key: str)`: Метод для удаления записи по указанному ключу `key` (полное имя владельца записи) из модели данных.
- `save(self)`: Метод для сохранения записей в модели данных в исходный XML-файл.

## View

### `MainScreen`

Этот класс представляет главный экран приложения и наследуется от класса `Screen` из Kivy. Он содержит различные виджеты, такие как таблицу, кнопки и поля ввода, для взаимодействия с пользователем.

#### Методы

- `__init__(self, _controller: Controller, **kw)`: Конструктор класса, инициализирует экран и его компоненты.
- `btn_del_press(self, instance)`: Метод-обработчик нажатия кнопки удаления. Удаляет выбранные записи из таблицы и фильтрует данные.
- `btn_save_press(self, instance)`: Метод-обработчик нажатия кнопки сохранения. Вызывает метод `save` контроллера для сохранения данных.
- `btn_load_press(self, instance)`: Метод-обработчик нажатия кнопки загрузки. Открывает диалоговое окно загрузки.
- `show_load_dialog(self)`: Метод для отображения диалогового окна загрузки.
- `dialog_load_cancel(self, *args)`: Метод-обработчик нажатия кнопки "Отмена" в диалоговом окне загрузки.
- `dialog_load_ok(self, *args)`: Метод-обработчик нажатия кнопки "Продолжить" в диалоговом окне загрузки. Изменяет модель контроллера и фильтрует данные.
- `btn_add_press(self, instance)`: Метод-обработчик нажатия кнопки добавления. Открывает диалоговое окно добавления новой записи.
- `show_addition_dialog(self)`: Метод для отображения диалогового окна добавления новой записи.
- `dialog_addition_cancel(self, *args)`: Метод-обработчик нажатия кнопки "Отмена" в диалоговом окне добавления.
- `dialog_addition_ok(self, *args)`: Метод-обработчик нажатия кнопки "Добавить" в диалоговом окне добавления. Создает новую запись и фильтрует данные.
- `filter_records(self)`: Метод для фильтрации записей в таблице на основе выбранных параметров поиска.

## Связь между классами

1. `MainScreen` имеет ссылку на экземпляр `Controller`, который используется для выполнения операций с данными.
2. `MainScreen` создает и управляет экземпляром `Table` для отображения данных.
3. При нажатии кнопок `Удалить`, `Сохранить` и `Загрузить`, `MainScreen` вызывает соответствующие методы `Controller`.
4. `Controller` добавляет, удаляет и сохраняет записи данных.
5. При нажатии кнопки `Добавить`, `MainScreen` вызывает метод `show_addition_dialog()`, который отображает диалоговое окно добавления новой записи.
6. При нажатии кнопки `Добавить` в диалоговом окне добавления, `MainScreen` вызывает метод `dialog_addition_ok()`, который создает новую запись и фильтрует данные.

